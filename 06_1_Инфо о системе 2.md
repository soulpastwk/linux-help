---
layout: default
title: "–ò–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è –∏ –∞—É–¥–∏—Ç Linux-—Å–∏—Å—Ç–µ–º"
permalink: /06_01_system-audit/
---

# üß© –ì–∞–π–¥ –ø–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∞—É–¥–∏—Ç—É Linux-—Å–∏—Å—Ç–µ–º

[![Platform](https://img.shields.io/badge/platform-Linux-lightgrey?style=flat-square&logo=linux)]()
[![Category](https://img.shields.io/badge/category-System%20Audit-blue?style=flat-square)]()
[![Tools](https://img.shields.io/badge/tools-systemctl%20|%20getent%20|%20dpkg%20|%20dnf%20|%20rpm-yellow?style=flat-square)]()

---

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [1Ô∏è‚É£ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Å–ª—É–∂–± –≤ —Å–∏—Å—Ç–µ–º–µ](#services)
- [2Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –≥—Ä—É–ø–ø—ã –∏ —Å—Ç–∞—Ç—É—Å—ã —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π](#users)
- [3Ô∏è‚É£ –°–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤](#packages)
- [4Ô∏è‚É£ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–µ –∏ –≤–µ—Ä—Å–∏–∏ –û–°](#os-info)
- [üß© –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã](#extra)
- [üíæ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞—É–¥–∏—Ç–∞](#automation)
- [üìò –ò—Ç–æ–≥](#summary)

---

## üìã –ë—ã—Å—Ç—Ä–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∫–æ–º–∞–Ω–¥

| –†–∞–∑–¥–µ–ª | –ö–æ–º–∞–Ω–¥–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü–æ–ª–µ–∑–Ω—ã–µ –æ–ø—Ü–∏–∏ |
|--------|----------|-------------|----------------|
| 1Ô∏è‚É£ –°–ª—É–∂–±—ã | `systemctl list-unit-files` | –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —é–Ω–∏—Ç—ã (—Å–ª—É–∂–±—ã, —Å–æ–∫–µ—Ç—ã, —Ç–∞—Ä–≥–µ—Ç—ã –∏ —Ç.–¥.) | `--type=service` ‚Äî —Ç–æ–ª—å–∫–æ —Å–ª—É–∂–±—ã |
| 2Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | `getent passwd` + `passwd -S` + `id` | –í—ã–≤–µ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏—Ö –≥—Ä—É–ø–ø—ã –∏ —Å—Ç–∞—Ç—É—Å –£–ó | –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ ‚Äî —á–µ—Ä–µ–∑ `sed` |
| 3Ô∏è‚É£ –ü–∞–∫–µ—Ç—ã (Debian/Ubuntu/Astra) | `dpkg-query -l` | –°–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ | `dpkg-query -L <pkg>` ‚Äî —Ñ–∞–π–ª—ã –ø–∞–∫–µ—Ç–∞ |
| 3Ô∏è‚É£ –ü–∞–∫–µ—Ç—ã (RedOS/Alt) | `dnf list installed` –∏–ª–∏ `rpm -qa` | –°–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ | `grep <pkg>` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ –∏–º–µ–Ω–∏ |
| 4Ô∏è‚É£ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–µ | `lsb_release -a`, `/etc/astra/*`, `/etc/redos-release` | –£–∑–Ω–∞—Ç—å –≤–µ—Ä—Å–∏—é –û–° | `cat /etc/os-release` ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± |

---

<a id="services"></a>
## ‚öôÔ∏è 1. –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Å–ª—É–∂–± –≤ —Å–∏—Å—Ç–µ–º–µ

–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —é–Ω–∏—Ç–æ–≤ (—Å–ª—É–∂–±, —Å–æ–∫–µ—Ç–æ–≤, —Ü–µ–ª–µ–π, —Ç–∞–π–º–µ—Ä–æ–≤ –∏ –ø—Ä.):

```bash
systemctl list-unit-files
````

üß† **–û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤:**

* **UNIT FILE** ‚Äî –∏–º—è —Ñ–∞–π–ª–∞ —é–Ω–∏—Ç–∞ (`.service`, `.socket`, `.target`, –∏ –¥—Ä.)
* **STATE** ‚Äî —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —é–Ω–∏—Ç–∞:

  * `enabled` ‚Äî –≤–∫–ª—é—á–µ–Ω, –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã
  * `disabled` ‚Äî –≤—ã–∫–ª—é—á–µ–Ω
  * `static` ‚Äî –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω –≤—Ä—É—á–Ω—É—é, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–∏–º–∏ —é–Ω–∏—Ç–∞–º–∏
  * `masked` ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω)

üìÇ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª (—É–¥–æ–±–Ω–æ –ø—Ä–∏ –º–∞—Å—Å–æ–≤–æ–º –∞—É–¥–∏—Ç–µ):**

```bash
HOSTNAME=$(hostname)
systemctl list-unit-files > /home/gis-audit/services_list_${HOSTNAME}
```

üí° **–°–æ–≤–µ—Ç:**
–î–ª—è –≤—ã–≤–æ–¥–∞ —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–ª—É–∂–±:

```bash
systemctl list-units --type=service --state=running
```

---

<a id="users"></a>

## üë• 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –≥—Ä—É–ø–ø—ã –∏ —Å—Ç–∞—Ç—É—Å—ã —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏—Ö –≥—Ä—É–ø–ø—ã –∏ —Å—Ç–∞—Ç—É—Å –ø–∞—Ä–æ–ª—è:

```bash
getent passwd | cut -d: -f1 | xargs -n1 -I {} sh -c 'passwd -S {}; id {}'
```

üß† **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞:**

* `getent passwd` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
* `cut -d: -f1` ‚Äî –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–º–µ–Ω–∞
* `passwd -S` ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∞—Ä–æ–ª—è
* `id` ‚Äî –≤—ã–≤–æ–¥–∏—Ç UID, GID –∏ –≥—Ä—É–ø–ø—ã

üîí **–°—Ç–∞—Ç—É—Å—ã:**

* `L` ‚Äî —É—á—ë—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
* `P` ‚Äî –∞–∫—Ç–∏–≤–Ω–∞, –ø–∞—Ä–æ–ª—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

üåà **–¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ (–Ω–∞ —ç–∫—Ä–∞–Ω–µ):**

```bash
getent passwd | cut -d: -f1 | xargs -n1 -I {} sh -c \
'passwd -S {} | sed "s/ L / \x1b[31mL\x1b[0m /; s/ P / \x1b[32mP\x1b[0m /"; id {}'
```

üìÇ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª:**

```bash
HOSTNAME=$(hostname)
getent passwd | cut -d: -f1 | xargs -n1 -I {} sh -c 'passwd -S {}; id {}' \
> /home/gis-audit/user_pass_group_active_${HOSTNAME}
```

üí° **–°–æ–≤–µ—Ç:**
–í—ã–≤–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```bash
getent passwd | cut -d: -f1 | xargs -I {} sh -c 'passwd -S {}' | grep " P "
```

---

<a id="packages"></a>

## üì¶ 3. –°–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

### üêß Debian / Ubuntu / Astra Linux

```bash
dpkg-query -l
```

üìÇ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª:**

```bash
dpkg-query -l > /home/gis-audit/dpkg_list_${HOSTNAME}
```

üîç **–ü—Ä–∏–º–µ—Ä—ã:**

```bash
dpkg-query -l nano                 # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–∞–∫–µ—Ç
dpkg-query -l | grep ^ii           # –¢–æ–ª—å–∫–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ
dpkg-query --status nano           # –°—Ç–∞—Ç—É—Å –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
dpkg-query -L nano                 # –§–∞–π–ª—ã –ø–∞–∫–µ—Ç–∞
```

---

### üî¥ Red OS / ALT Linux / RHEL-–ø–æ–¥–æ–±–Ω—ã–µ

```bash
dnf list installed
# –∏–ª–∏
yum list installed
# –∏–ª–∏
rpm -qa
```

üîç **–ü—Ä–∏–º–µ—Ä—ã:**

```bash
rpm -qa | grep firefox
rpm -qi nano     # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–∫–µ—Ç–µ
rpm -ql nano     # –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –ø–∞–∫–µ—Ç–∞
```

üìÇ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª:**

```bash
rpm -qa > /home/gis-audit/rpm_list_${HOSTNAME}
```

üí° **–°–æ–≤–µ—Ç:**
–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–≤–æ–¥:

```bash
dnf list installed | awk '{print $1, $2}' | column -t
```

---

<a id="os-info"></a>

## üß≠ 4. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–µ –∏ –≤–µ—Ä—Å–∏–∏ –û–°

### üü¢ Astra Linux

```bash
lsb_release -a
cat /etc/astra/build_version
cat /etc/astra_license
cat /var/log/astra-history.log
```

üí° **–ö—Ä–∞—Ç–∫–∏–π –≤—ã–≤–æ–¥:**

```bash
lsb_release -d
```

---

### üî¥ Red OS 7.3 / 8.0

```bash
cat /etc/redos-release
cat /etc/os-release
hostnamectl
uname -a
cat /etc/issue
```

---

<a id="extra"></a>

## üß© –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –¶–µ–ª—å                           | –ö–æ–º–∞–Ω–¥–∞                 | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π               |
| ------------------------------ | ----------------------- | ------------------------- |
| –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–Ω—è—Ç–æ–µ –º–µ—Å—Ç–æ        | `df -h`                 | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–æ–≤      |
| –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ | `free -h`               | –û–ó–£                       |
| –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É CPU         | `top`, `htop`           | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤      |
| –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è            | `ss -tulpn`             | –ü–æ—Ä—Ç—ã –∏ PID               |
| –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ª—É–∂–±           | `systemd-analyze blame` | –ß—Ç–æ –¥–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Å—Ç–∞—Ä—Ç—É–µ—Ç |
| –°–µ—Ç–µ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã             | `ip a`                  | IP, MAC, —Å—Ç–∞—Ç—É—Å           |

---

<a id="automation"></a>

## üíæ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞—É–¥–∏—Ç–∞

üì¶ –ü—Ä–∏–º–µ—Ä —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –∞—É–¥–∏—Ç–∞:

```bash
#!/bin/bash
HOSTNAME=$(hostname)
AUDIT_DIR="/home/gis-audit"
mkdir -p $AUDIT_DIR

echo "[*] –°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å $HOSTNAME..."

systemctl list-unit-files > $AUDIT_DIR/services_list_${HOSTNAME}
getent passwd | cut -d: -f1 | xargs -n1 -I {} sh -c 'passwd -S {}; id {}' > $AUDIT_DIR/user_pass_group_active_${HOSTNAME}
dpkg-query -l > $AUDIT_DIR/dpkg_list_${HOSTNAME} 2>/dev/null || rpm -qa > $AUDIT_DIR/rpm_list_${HOSTNAME}
lsb_release -a > $AUDIT_DIR/os_info_${HOSTNAME} 2>/dev/null || cat /etc/os-release > $AUDIT_DIR/os_info_${HOSTNAME}
df -h > $AUDIT_DIR/disk_usage_${HOSTNAME}
free -h > $AUDIT_DIR/memory_usage_${HOSTNAME}

echo "[+] –ê—É–¥–∏—Ç –∑–∞–≤–µ—Ä—à—ë–Ω. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ ${AUDIT_DIR}"
```

---

<a id="summary"></a>

## üìò –ò—Ç–æ–≥

üìó –≠—Ç–æ—Ç –≥–∞–π–¥ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:

* –ë—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
* –ú–∞—Å—Å–æ–≤–æ–≥–æ –∞—É–¥–∏—Ç–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ (—á–µ—Ä–µ–∑ SSH)
* –°–±–æ—Ä–∫–∏ –æ—Ç—á—ë—Ç–æ–≤ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–∏

üí° –°–æ–≤–º–µ—Å—Ç–∏–º —Å:

* Astra Linux
* Red OS
* ALT Linux
* Ubuntu / Debian
* CentOS / RHEL

