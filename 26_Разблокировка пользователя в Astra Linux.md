---
layout: default
title: "üîì –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Astra Linux 1.7.9 (—É—Å–∏–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º)"
permalink: /unlock_user_astra/
---

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [1. –í–≤–µ–¥–µ–Ω–∏–µ](#intro)
- [2. –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ LiveCD (–ø–æ—à–∞–≥–æ–≤–æ)](#livecd)
- [3. –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ PAM](#pamfiles)
- [4. –°–±—Ä–æ—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—Ä—É—á–Ω—É—é](#reset)
- [5. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞ (CyberBackup)](#restore)
- [6. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ PAM-–º–æ–¥—É–ª—è](#detect)
- [7. –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ —Å–æ–≤–µ—Ç—ã](#tips)

---

<a id="intro"></a>
## 1Ô∏è‚É£ –í–≤–µ–¥–µ–Ω–∏–µ

üîê –í Astra Linux 1.7.9 (–°–º–æ–ª–µ–Ω—Å–∫) —Å **—É—Å–∏–ª–µ–Ω–Ω—ã–º —Ä–µ–∂–∏–º–æ–º –≤—Ö–æ–¥–∞ (—É—Ä–æ–≤–µ–Ω—å 63)** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω —Å–∏—Å—Ç–µ–º–æ–π PAM –ø–æ—Å–ª–µ –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞.  
–ï—Å–ª–∏ –≤–≤–µ–¥–µ–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, 60 –Ω–µ–≤–µ—Ä–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π ‚Äî —É—á—ë—Ç–∫–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è **–Ω–∞–≤—Å–µ–≥–¥–∞**, –ø–æ–∫–∞ –Ω–µ —Å–±—Ä–æ—Å–∏—Ç—å —Å—á—ë—Ç—á–∏–∫–∏ –≤—Ä—É—á–Ω—É—é.

üí° –ü—Ä–∏ —ç—Ç–æ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ, –µ—Å–ª–∏ –µ—Å—Ç—å **–¥–æ—Å—Ç—É–ø –∫ –º–∞—à–∏–Ω–µ** (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ LiveCD).

# ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [Kali Linux](https://www.kali.org/get-kali/#kali-live)

<a id="livecd"></a>

## 2Ô∏è‚É£ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —á–µ—Ä–µ–∑ LiveCD (–ø–æ—à–∞–≥–æ–≤–æ)

ü™ú **–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:**

1. **–ó–∞–≥—Ä—É–∑–∏—Å—å —Å LiveCD Astra Linux**
   - –í—ã–±–µ—Ä–∏ —Ä–µ–∂–∏–º *Live* –∏–ª–∏ *–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ*.
2. **–û–ø—Ä–µ–¥–µ–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π —Ä–∞–∑–¥–µ–ª**

```bash
   fdisk -l
````

–∏–ª–∏

```bash
lsblk
```

3. **–°–º–æ–Ω—Ç–∏—Ä—É–π —Ä–∞–∑–¥–µ–ª**

   ```bash
   mkdir /mnt/sysroot
   mount /dev/sda2 /mnt/sysroot
   mount /dev/sda1 /mnt/sysroot/boot   # –µ—Å–ª–∏ –µ—Å—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π /boot
   ```
4. **–ü–æ–¥–∫–ª—é—á–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∏ –∏ –≤–æ–π–¥–∏ –≤ chroot**

   ```bash
   mount --bind /dev /mnt/sysroot/dev
   mount --bind /proc /mnt/sysroot/proc
   mount --bind /sys /mnt/sysroot/sys
   chroot /mnt/sysroot
   ```
5. **–ü—Ä–æ–≤–µ—Ä—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

   ```bash
   pam_tally2 --user –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   ```

   –∏–ª–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è faillock)

   ```bash
   faillock --user –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   ```
6. **–°–±—Ä–æ—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏**

   ```bash
   pam_tally2 --user –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è --reset
   # –∏–ª–∏
   faillock --user –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è --reset
   ```
7. **–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ ‚Äî —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–π –≤ /etc/shadow**

   ```bash
   nano /etc/shadow
   ```

   –£–¥–∞–ª–∏ `!` –∏–ª–∏ `!!` –ø–µ—Ä–µ–¥ —Ö—ç—à–µ–º –ø–∞—Ä–æ–ª—è.
8. **–°–±—Ä–æ—Å—å –ø–∞—Ä–æ–ª—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**

   ```bash
   passwd –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   ```
9. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏**

   ```bash
   exit
   umount /mnt/sysroot/{dev,proc,sys,boot,}
   reboot
   ```

---

<a id="pamfiles"></a>

## 3Ô∏è‚É£ –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ PAM

üîç –ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –º–æ–¥—É–ª—è PAM:

| –ú–æ–¥—É–ª—å PAM                  | –§–∞–π–ª / –ü–∞–ø–∫–∞                                  | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                               |
| --------------------------- | --------------------------------------------- | ---------------------------------------- |
| üß± `pam_tally2`             | `/var/log/tallylog`                           | –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —É—á—ë—Ç–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤     |
| üß© `pam_faillock`           | `/var/run/faillock/` –∏–ª–∏ `/var/lib/faillock/` | –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| üõ°Ô∏è `UMC` (—É—Å–∏–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º) | `/etc/umc/users/` –∏–ª–∏ `/var/lib/umc/`         | –§–∞–π–ª—ã —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∏ —Ñ–ª–∞–≥–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ |

---

<a id="reset"></a>

## 4Ô∏è‚É£ –°–±—Ä–æ—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤—Ä—É—á–Ω—É—é

üß∞ –ï—Å–ª–∏ —Ç—ã —É–∂–µ –≤ **LiveCD chroot**:

### –î–ª—è `pam_tally2`

```bash
> /var/log/tallylog
# –∏–ª–∏
rm /var/log/tallylog
```

### –î–ª—è `pam_faillock`

```bash
rm -f /var/run/faillock/*
# –∏–ª–∏
rm -f /var/lib/faillock/*
```

### –î–ª—è UMC (—É—Å–∏–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º)

```bash
umc-user -u –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -E
```

–∏–ª–∏ –≤—Ä—É—á–Ω—É—é –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π/—É–¥–∞–ª–∏ —Ñ–∞–π–ª `/etc/umc/users/–∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è`.

---

<a id="restore"></a>

## 5Ô∏è‚É£ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞ (CyberBackup)

üíæ –ï—Å–ª–∏ –µ—Å—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è —Å–∏—Å—Ç–µ–º—ã ‚Äî –º–æ–∂–Ω–æ **–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã**, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è –≤—Å—ë `/etc`.

| –ß—Ç–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å                              | –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ               | –≠—Ñ—Ñ–µ–∫—Ç                           |
| --------------------------------------------- | ------------------------- | -------------------------------- |
| `/var/log/tallylog`                           | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pam_tally2   | –°–±—Ä–æ—Å –≤—Å–µ—Ö –Ω–µ—É–¥–∞—á–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤      |
| `/var/run/faillock/` –∏–ª–∏ `/var/lib/faillock/` | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pam_faillock | –°–±—Ä–æ—Å –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫                 |
| `/etc/umc/users/` –∏–ª–∏ `/var/lib/umc/`         | –£—Ä–æ–≤–µ–Ω—å 63 (UMC –∞–∫—Ç–∏–≤–µ–Ω)  | –°–Ω—è—Ç–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π               |
| `/etc/passwd`, `/etc/shadow`, `/etc/group`    | –ü—Ä–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–∏ —É—á—ë—Ç–æ–∫    | –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∏ –ø–∞—Ä–æ–ª–µ–π |

‚ö†Ô∏è –ù–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π –≤–µ—Å—å `/etc` ‚Äî –º–æ–∂–Ω–æ –Ω–∞—Ä—É—à–∏—Ç—å PAM-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

---

<a id="detect"></a>

## 6Ô∏è‚É£ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ PAM-–º–æ–¥—É–ª—è

–ü—Ä–æ–≤–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```bash
cat /etc/pam.d/common-auth
```

üîé –ï—Å–ª–∏ –µ—Å—Ç—å:

```
auth required pam_tally2.so deny=5 unlock_time=never
```

‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **pam_tally2**
üìÅ –°–º–æ—Ç—Ä–∏ `/var/log/tallylog`

–∏–ª–∏:

```
auth required pam_faillock.so preauth audit silent deny=5 unlock_time=0
```

‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **pam_faillock**
üìÅ –°–º–æ—Ç—Ä–∏ `/var/run/faillock/` –∏–ª–∏ `/var/lib/faillock/`

---

<a id="tips"></a>

## 7Ô∏è‚É£ –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ —Å–æ–≤–µ—Ç—ã

üß© –ü—Ä–æ–≤–µ—Ä–∫–∞ PAM –ª–æ–≥–æ–≤:

```bash
grep pam /var/log/auth.log
journalctl -xe | grep pam
```

üîß –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–Ω—è—Ç–∏–µ —É—Ä–æ–≤–Ω—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–ø—Ä–∏ —É—Ä–æ–≤–Ω–µ 63):

```bash
setumc -s 0
```

üß± –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –æ–±—Ä–∞—Ç–Ω–æ:

```bash
setumc -s 63
```

üí° –ü—Ä–∏ —Å–æ–º–Ω–µ–Ω–∏–∏ ‚Äî –≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π —Å—Ç—Ä–æ–∫–∏ `pam_tally2.so` –∏–ª–∏ `pam_faillock.so` –≤ `/etc/pam.d/common-auth`,
–≤–æ–π–¥–∏, —Å–±—Ä–æ—Å—å —Å—á—ë—Ç—á–∏–∫–∏ –∏ –≤–µ—Ä–Ω–∏ –æ–±—Ä–∞—Ç–Ω–æ.

---

‚ú≥Ô∏è **–ò—Ç–æ–≥:**

> –í Astra Linux 1.7.9 –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —É—á—ë—Ç–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ ‚Äî —á–µ—Ä–µ–∑ LiveCD, –æ—á–∏—Å—Ç–∫—É `/var/log/tallylog` –∏–ª–∏ `/var/run/faillock/`, –∏ –ø—Ä–æ–≤–µ—Ä–∫—É UMC-—Ñ–∞–π–ª–æ–≤.
> –ì–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å —Ü–µ–ª–∏–∫–æ–º `/etc`, –∞ —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã PAM.
